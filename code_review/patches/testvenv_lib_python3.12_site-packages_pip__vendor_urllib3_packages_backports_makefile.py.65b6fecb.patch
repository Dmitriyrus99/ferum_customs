--- a/testvenv/lib/python3.12/site-packages/pip/_vendor/urllib3/packages/backports/makefile.py
+++ b/testvenv/lib/python3.12/site-packages/pip/_vendor/urllib3/packages/backports/makefile.py
@@ -28,7 +28,12 @@
     if writing:
         rawmode += "w"
     raw = SocketIO(self, rawmode)
+    
+    # Ensure _makefile_refs attribute exists
+    if not hasattr(self, '_makefile_refs'):
+        self._makefile_refs = 0
     self._makefile_refs += 1
+    
     if buffering is None:
         buffering = -1
     if buffering < 0:
@@ -48,4 +53,4 @@
         return buffer
     text = io.TextIOWrapper(buffer, encoding, errors, newline)
     text.mode = mode
-    return text
+    return text
