--- a/ferum_customs/bench_commands/run_tests.py
+++ b/ferum_customs/bench_commands/run_tests.py
@@ -1,13 +1,47 @@
-1. **Directory Traversal Vulnerability**: The code does not properly sanitize the `app` and `test_path` inputs, which could allow for directory traversal attacks. Use `os.path.abspath()` and validate against a base directory.
-   
-2. **Environment Variable Injection**: Setting `os.environ["SITE_NAME"]` directly can lead to issues if the environment variable is used elsewhere in the application. Consider using a context manager or a safer method to handle environment variables.
+import os
+import sys
+import click
+import pytest
+import logging
 
-3. **Error Handling**: Raising a `ValueError` without catching it may cause the program to exit unexpectedly. Consider using `click.ClickException` for better integration with Click's error handling.
+# Configure logging
+logging.basicConfig(level=logging.INFO)
 
-4. **Exit Code Handling**: Using `exit()` directly can be problematic in some contexts (e.g., when this script is imported as a module). Instead, consider returning the exit code or using `sys.exit()`.
+@click.command()
+@click.argument('app')
+@click.argument('test_path', type=str)
+def run_tests(app: str, test_path: str):
+    # Directory Traversal Protection
+    base_dir = os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))
+    app_path = os.path.abspath(os.path.join(base_dir, app))
+    test_path = os.path.abspath(os.path.join(base_dir, test_path))
 
-5. **Missing Type Hint for `test_path`**: The `test_path` parameter should have a type hint for consistency and clarity.
+    if not app_path.startswith(base_dir) or not test_path.startswith(base_dir):
+        raise click.ClickException("Invalid path: potential directory traversal detected.")
 
-6. **Lack of Logging**: There is no logging for the execution of tests, which can be useful for debugging and monitoring.
+    # Environment Variable Handling
+    original_site_name = os.environ.get("SITE_NAME")
+    os.environ["SITE_NAME"] = app
 
-7. **Potential for Unhandled Exceptions**: If `pytest.main()` raises an exception, it will not be caught, leading to an unhandled exception. Consider wrapping it in a try-except block.
+    try:
+        # Logging the start of the test
+        logging.info(f"Running tests for app: {app} at path: {test_path}")
+
+        # Run tests and handle potential exceptions
+        try:
+            exit_code = pytest.main([test_path])
+        except Exception as e:
+            logging.error(f"An error occurred while running tests: {e}")
+            raise click.ClickException(f"An error occurred while running tests: {e}")
+
+        # Return or exit with the appropriate exit code
+        sys.exit(exit_code)
+    finally:
+        # Restore the original environment variable
+        if original_site_name is not None:
+            os.environ["SITE_NAME"] = original_site_name
+        else:
+            del os.environ["SITE_NAME"]
+
+if __name__ == '__main__':
+    run_tests()
