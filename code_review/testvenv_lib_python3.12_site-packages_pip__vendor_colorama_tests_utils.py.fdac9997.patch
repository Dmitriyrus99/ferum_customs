--- a/testvenv/lib/python3.12/site-packages/pip/_vendor/colorama/tests/utils.py
+++ b/testvenv/lib/python3.12/site-packages/pip/_vendor/colorama/tests/utils.py
@@ -19,8 +19,10 @@
 def osname(name):
     orig = os.name
     os.name = name
-    yield
-    os.name = orig
+    try:
+        yield
+    finally:
+        os.name = orig
 
 
 @contextmanager
@@ -29,9 +31,11 @@
     orig_stderr = sys.stderr
     sys.stdout = stream
     sys.stderr = stream
-    yield
-    sys.stdout = orig_stdout
-    sys.stderr = orig_stderr
+    try:
+        yield
+    finally:
+        sys.stdout = orig_stdout
+        sys.stderr = orig_stderr
 
 
 @contextmanager
@@ -40,9 +44,11 @@
     orig_stderr = sys.__stderr__
     sys.__stdout__ = stream
     sys.__stderr__ = stream
-    yield
-    sys.__stdout__ = orig_stdout
-    sys.__stderr__ = orig_stderr
+    try:
+        yield
+    finally:
+        sys.__stdout__ = orig_stdout
+        sys.__stderr__ = orig_stderr
 
 
 @contextmanager
@@ -51,4 +57,4 @@
     non_tty = StreamNonTTY()
     with replace_by(non_tty), replace_original_by(non_tty):
         yield
-    del os.environ["PYCHARM_HOSTED"]
+    del os.environ["PYCHARM_HOSTED"]